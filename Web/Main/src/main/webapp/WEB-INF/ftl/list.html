<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang='zh-CN' xml:lang='zh-CN' xmlns='http://www.w3.org/1999/xhtml'>
    <head>
        <#include "/top.html"/>
        <style type="text/css">
            .pagination.square {
                margin: 0;/* 去除外边距 */
            }
            pagination.square > li > a, .pagination.square > li > span {
                margin: 0 5px;
                border: 1px solid #dddddd; /* 设置所有的边框都为1像素 */
            }
            pagination.square > li:first-child > a, .pagination.square > li:first-child > span, .pagination.square > li:last-child > a, .pagination.square > li:last-child > span {
                margin-left: 0px;
                padding-left: 10px;
                padding-right: 10px;
                border-radius: 0px; /* 取消圆角 */
            }
        </style>
    </head>
    <body>

        <div class="modal fade" id="new">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                            ×
                        </button>
                        <h4 class="modaltitle" id="myModalLabel">新增用户</h4>
                    </div>
                    <div class="modal-body">
                        <form class="form-horizontal" method = "post">
                            <div class="form-group">
                                <label for="loginName" class="col-sm-2 control-label">登录名</label>

                                <div class="col-sm-5">
                                    <input type="text" class="form-control" name="loginName" placeholder="用户名">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="password" class="col-sm-2 control-label">登录密码</label>

                                <div class="col-sm-5">
                                    <input type="password" class="form-control" name="loginPwd" placeholder="密码">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="nickName" class="col-sm-2 control-label">昵称</label>

                                <div class="col-sm-5">
                                    <input type="text" class="form-control" name="nickName" placeholder="昵称">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="sex" class="col-sm-2 control-label">性别</label>

                                <div class="col-sm-5">
                                    <input type="text" class="form-control" name="sex" placeholder="性别">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="mobileNo" class="col-sm-2 control-label">手机号</label>

                                <div class="col-sm-5">
                                    <input type="text" class="form-control" name="mobileNo" placeholder="手机号">
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-success" id="add_user">保存</button>
                                <button type="button" class="btn btn-default" data-dismiss="modal">
                                    取消
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="view">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                            ×
                        </button>
                        <h4 class="modaltitle" id="myModalLabel">用户信息</h4>
                    </div>
                    <div class="modal-body">
                        <form class="form-horizontal" method = "post" action = "add.do">
                            <div class="form-group">
                                <label for="firstname" class="col-sm-2 control-label">登录密码</label>

                                <div class="col-sm-5">
                                    <input type="text" class="form-control" name="loginPwd" placeholder="Please Input Firestname">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="lastname" class="col-sm-2 control-label">登录名</label>

                                <div class="col-sm-5">
                                    <input type="text" class="form-control" name="loginName" placeholder="Please Input Lastname">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="lastname" class="col-sm-2 control-label">昵称</label>

                                <div class="col-sm-5">
                                    <input type="text" class="form-control" name="nickName" placeholder="Please Input Lastname">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="lastname" class="col-sm-2 control-label">性别</label>

                                <div class="col-sm-5">
                                    <input type="text" class="form-control" name="sex" placeholder="Please Input Lastname">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="lastname" class="col-sm-2 control-label">手机号</label>

                                <div class="col-sm-5">
                                    <input type="text" class="form-control" name="mobileNo" placeholder="Please Input Lastname">
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-default" data-dismiss="modal">
                                    取消
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="panel panel-primary">
                <div class="panel-heading clearfix">
                    <div class="pull-right">
                        右边区域
                    </div>
                    <div class="pull-left">
                        <a class="btn btn-mini btn-success" data-toggle="modal" data-target="#new" data-backdrop="static">新增</a>
                        <a title="批量删除" class="btn btn-mini btn-danger" onclick="makeAll('确定要删除选中的数据吗?');" ><i class='icon-trash'></i></a>
                    </div>
                </div>
                <table class="table table-bordered table-hover">
                    <thead>
                        <tr>
                            <th class="center"><label>
                                <input type="checkbox" id="zcheckbox" />
                                <span class="lbl"></span></label></th>
                            <th>id</th>
                            <th>登录密码</th>
                            <th>登录名</th>
                            <th>昵称</th>
                            <th>性别</th>
                            <th><i class="icon-envelope"></i>手机号</th>
                            <th><i class="icon-time hidden-phone"></i>登录错误次数</th>
                            <th>上次登录时间</th>
                            <th class="center">操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <#list userList as user>
                        <!-- 开始循环 -->
                        <tr>
                            <td class='center' style="width: 30px;">
                            <input type='checkbox' name='ids' value="${user.id}" id="${user.mobileNo}" alt="${user.mobileNo}"/>
                            <span class="lbl"></span></label></td>
                            <td>${user.id}</td>
                            <td>${user.loginPwd}</td>
                            <td>${user.loginName}</td>
                            <td>${user.nickName}</td>
                            <td>${user.sex}</td>
                            <td>${user.mobileNo}</td>
                            <td>${user.loginErrCount}</td>
                            <td>${user.lastLoginTime!''}</td>
                            <td>
                            <div class='hidden-phone visible-desktop btn-group'>
                                <a class='btn btn-mini btn-info' title="查看" data-toggle="modal" data-target="#view" ><i class='icon-info-sign'></i></a>
                                <a class='btn btn-mini btn-info' title="编辑" onclick="editUser('${user.USER_ID }');"><i class='icon-edit'></i></a>
                                <a class='btn btn-mini btn-danger' title="删除" onclick="deleteU('${user.id }','${user.loginName }');"><i class='icon-trash'></i></a>
                            </div></td>
                        </tr>
                        </#list>
                    </tbody>
                    <tfoot></tfoot>
                </table>
                <ul class="list-group">
                    <li class="list-group-item">
                        <ul class="pagination ">
                            <li class="disabled">
                                <span>Prev</span>
                            </li>
                            <li class="active">
                                <a href="#">1 <span class="sr-only">(current) </span></a>
                            </li>
                            <li>
                                <a href="#">2</a>
                            </li>
                            <li>
                                <a href="#">3</a>
                            </li>
                            <li>
                                <a href="#">4</a>
                            </li>
                            <li class="disabled">
                                <span>...</span>
                            </li>
                            <li>
                                <a href="#">14</a>
                            </li>
                            <li>
                                <a href="#">15</a>
                            </li>
                            <li>
                                <a href="#">16</a>
                            </li>
                            <li>
                                <a href="#">17</a>
                            </li>
                            <li>
                                <a href="#">Next</a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
        <script type="text/javascript">
            function deleteU(userId, msg) {
                bootbox.confirm("确定要删除[" + msg + "]吗?", function(result) {
                    if (result) {
                        var url = "delete.do?id=" + userId + "&tm=" + new Date().getTime();
                        location.reload();
                    }
                });
            }


            $(document).ready(function() {

                $('#add_user').click(function() {
                    alert("hi");
                        location.reload();
/*
                    $.post('${rc.getContextPath()}' + '/user/add.do', {
                        loginName : $('#loginName').val(),
                        loginPwd : $('#loginPwd').val(),
                        nickName : $('#nickName').val(),
                        sex : $('#sex').val(),
                        mobileNo : $('#mobileNo').val()
                    }, function(data, status) {
                        if (data == '1') {
                            createPopOver('#loginName', 'right', '用户名不能为空', 'show');
                        } else if (data == '2') {
                            createPopOver('#loginPwd', 'right', '密码不能为空', 'show');
                        } else if (data == '3') {
                            createPopOver('#nickName', 'right', '用户名不存在', 'show');
                        } else if (data == '4') {
                            createPopOver('#sex', 'right', '密码错误', 'show');
                        } else if (data == '5') {
                            createPopOver('#mobileNo', 'right', '密码错误', 'show');
                        } else if (data == '6') {
                            location.href = '${rc.getContextPath()}' + '/user/list.do';
                        }
                    });
                    */
                });

                function createPopOver(id, placement, content, action) {
                    $(id).popover({
                        placement : placement,
                        content : content
                    });
                    $(id).popover(action);
                }


                $('#loginName').click(function() {
                    $('#loginName').popover('destroy');
                });

                $('#loginPwd').click(function() {
                    $('#loginPwd').popover('destroy');
                });

                $('#nickName').click(function() {
                    $('#nickName').popover('destroy');
                });

                $('#sex').click(function() {
                    $('#sex').popover('destroy');
                });

                $('#mobileNo').click(function() {
                    $('#mobileNo').popover('destroy');
                });
            });
        </script>
    </body>
</html>